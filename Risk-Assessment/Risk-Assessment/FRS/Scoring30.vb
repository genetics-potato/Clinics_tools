Imports Microsoft.VisualBasic.ComponentModel.Algorithm.base
Imports Microsoft.VisualBasic.Math.LinearAlgebra
Imports Microsoft.VisualBasic.Serialization.JSON

Namespace FRS

    ''' <summary>
    ''' ##### Framingham Risk Score
    ''' 
    ''' The Framingham Risk Score is a gender-specific algorithm used to estimate the 10-year cardiovascular risk of an individual. 
    ''' The Framingham Risk Score was first developed based on data obtained from the Framingham Heart Study, to estimate the 10-year 
    ''' risk of developing coronary heart disease.[1] In order to assess the 10-year cardiovascular disease risk, cerebrovascular 
    ''' events, peripheral artery disease and heart failure were subsequently added as disease outcomes for the 2008 Framingham 
    ''' Risk Score, on top of coronary heart disease.
    ''' 
    ''' > https://en.wikipedia.org/wiki/Framingham_Risk_Score
    ''' </summary>
    Public Module Scoring30

        ' Project - CVHCWeb, Mayo Clinic Rochester
        ' Created on Mar 30, 2011
        '
        ' These calculations are based On the framingham 30 year risk study located at
        ' http://circ.ahajournals.org/cgi/content/short/CIRCULATIONAHA.108.816694v1 Specifically, these calculations are a
        ' reverse engineering Of the spreadsheet located at
        ' http://circ.ahajournals.org/content/vol0/issue2009/images/data/CIRCULATIONAHA.108.816694/DC1/CI816694.DSriskcalculator.xls

        ' SPECIAL NOTE: As of 4/8/2011 there Is a bug on the spreadsheet listed above regarding the normal risk scores.  These risk 
        '               scores do Not take into account the difference between male/female.  This code has been updated to address
        '               this issue, however the spreadsheet may Not.

        ' Authors: Michael J. Pencina PhD, Ralph B. D'Agostino Sr PhD, Martin G. Larson ScD, Joseph M. Massaro PhD, and
        ' Ramachandran S. Vasan MD.

        ' Excel spreadsheet calculations have been translated To Java by Aaron Vaneps (Vaneps.Michael@mayo.edu), And I make no
        ' guarantee that there are no bugs In the translation. Use at your own risk.

        ''' <summary>
        ''' Calculates the full CVD risk which consists of the hard CVD risk in addition to the risk of coronary
        ''' insufficiency, angina pectoris, transient ischemic attack, intermittent claudication Or congestive heart failure.
        ''' </summary>
        ''' <param name="age">age of the patient, in years.</param>
        ''' <param name="isMale">true if patient is male, false if female</param>
        ''' <param name="systolicBp">systolic blood pressure</param>
        ''' <param name="cholesterol">total cholesterol</param>
        ''' <param name="hdl">high density lipoprotein</param>
        ''' <param name="smoker">true if patient smokes, false if not</param>
        ''' <param name="treatedBp">true if patient is taking medications to treat high blood pressure, false if not</param>
        ''' <param name="diabetic">true if patient is diabetic, false if not</param>
        ''' <returns>
        ''' A JSON object with the risk percentages in the form of:
        ''' 
        ''' ```json
        ''' {"risk"  -1.0, "optimalRisk": -1.0, "normalRisk": -1.0}
        ''' ```
        ''' 
        ''' Note that -1 means something went wrong, otherwise it will be the percent risk.
        ''' </returns>
        Public Function calculateFullRiskNoBmi(age#, isMale As Boolean, systolicBp#, cholesterol#, hdl#, smoker As Boolean, treatedBp As Boolean, diabetic As Boolean) As Score30
            Dim returnObj As New Score30 With {
                .risk = calculateFullRiskNoBmiInternal(age, isMale, systolicBp, cholesterol, hdl, smoker, treatedBp, diabetic),
                .optimalRisk = calculateFullRiskNoBmiInternal(age, isMale, 110, 160, 60, False, False, False),
                .normalRisk = calculateFullRiskNoBmiInternal(age, isMale, 125, 180, 45, False, False, False)
            }
            Return returnObj
        End Function

        Private Function calculateFullRiskNoBmiInternal(age#, isMale As Boolean, systolicBp#, cholesterol#, hdl#, smoker As Boolean, treatedBp As Boolean, diabetic As Boolean) As Double
            Dim E As Vector = {
                0.999874296, 0.999874296, 0.999874296, 0.999748519, 0.999622704, 0.999622704, 0.999496803,
                0.999370849, 0.999370849, 0.999370849, 0.999244705, 0.999244705, 0.99911853, 0.99911853, 0.99911853,
                0.998992174, 0.998865757, 0.998739283, 0.998612704, 0.998612704, 0.998612704, 0.998486005, 0.998359261,
                0.998232504, 0.998105675, 0.997978839, 0.997851933, 0.997851933, 0.997851933, 0.997724749, 0.997597515,
                0.997470181, 0.997342824, 0.997342824, 0.997215427, 0.997215427, 0.997087879, 0.996960256, 0.996960256,
                0.996960256, 0.996960256, 0.996832045, 0.996703795, 0.996575514, 0.996447164, 0.996318743, 0.996318743,
                0.996190148, 0.996061122, 0.995932052, 0.995802901, 0.995673626, 0.995544206, 0.995414666, 0.995284937,
                0.99515505, 0.995025081, 0.995025081, 0.995025081, 0.994894865, 0.994764513, 0.994634039, 0.994503411,
                0.994503411, 0.994503411, 0.994372668, 0.994241919, 0.994110783, 0.993979643, 0.99384838, 0.993717032,
                0.99358538, 0.993453732, 0.993322039, 0.993190335, 0.993058573, 0.992926616, 0.992794617, 0.992662602,
                0.992530547, 0.992398482, 0.992266422, 0.99213433, 0.992002235, 0.991870046, 0.991737769, 0.991605443,
                0.991473096, 0.991340627, 0.991208044, 0.991075452, 0.990942808, 0.990810007, 0.990677101, 0.990544031,
                0.99041084, 0.990277491, 0.990144063, 0.990010525, 0.989877001, 0.989743334, 0.989609467, 0.989475554,
                0.989341599, 0.989207647, 0.989073673, 0.988939555, 0.988805391, 0.988671231, 0.988671231, 0.988537062,
                0.988402883, 0.988268691, 0.988134423, 0.988000123, 0.987865777, 0.987731408, 0.987596881, 0.98746234,
                0.987327798, 0.987193229, 0.987058645, 0.986924022, 0.986789375, 0.986654394, 0.986519398, 0.986384286,
                0.986384286, 0.986249068, 0.986113843, 0.986113843, 0.985978289, 0.985978289, 0.985978289, 0.985842542,
                0.985706568, 0.985570488, 0.985434336, 0.985297906, 0.985297906, 0.985161383, 0.985024827, 0.984888162,
                0.984751508, 0.984614825, 0.98447809, 0.984341371, 0.984341371, 0.984204554, 0.984067557, 0.983930384,
                0.983930384, 0.983793063, 0.983655684, 0.983518256, 0.983380646, 0.983242918, 0.983105116, 0.982967179,
                0.982967179, 0.982967179, 0.982967179, 0.982967179, 0.982828783, 0.982690349, 0.982551894, 0.982412785,
                0.982273637, 0.982134487, 0.981995136, 0.981855744, 0.981716262, 0.981576767, 0.981576767, 0.981576767,
                0.981576767, 0.981437115, 0.981437115, 0.981297367, 0.981157515, 0.981017606, 0.980877662, 0.980737695,
                0.980597721, 0.980457516, 0.980317278, 0.980317278, 0.980176964, 0.98003653, 0.979896053, 0.979755489,
                0.979614885, 0.979474273, 0.979333587, 0.979192752, 0.979051888, 0.978910968, 0.978769968, 0.978628829,
                0.978628829, 0.978628829, 0.978487594, 0.978346298, 0.978346298, 0.978204743, 0.978204743, 0.978062894,
                0.978062894, 0.977920908, 0.977778907, 0.977778907, 0.977636652, 0.977494371, 0.977352026, 0.977352026,
                0.97720962200000006, 0.977066907, 0.976924135, 0.976924135, 0.976781251, 0.97663828, 0.976495262, 0.976352089,
                0.976208855, 0.976065627, 0.976065627, 0.975922003, 0.975778365, 0.975634644, 0.975490766, 0.975346853,
                0.975202466, 0.975202466, 0.975057997, 0.974913545, 0.974769045, 0.974624521, 0.974624521, 0.974479884,
                0.974335227, 0.974335227, 0.974190549, 0.974190549, 0.974190549, 0.974045614, 0.973900631, 0.973755587,
                0.973610487, 0.973465252, 0.973465252, 0.973465252, 0.973319553, 0.973173871, 0.973028141, 0.9728824,
                0.9728824, 0.972736535, 0.972736535, 0.972590658, 0.972444751, 0.972298724, 0.972152695, 0.972006611,
                0.971860537, 0.971714419, 0.971568153, 0.971421695, 0.971275181, 0.971128648, 0.970982126, 0.970835606,
                0.970835606, 0.97068888, 0.970542117, 0.970395279, 0.970395279, 0.970395279, 0.970248233, 0.970101034,
                0.969953813, 0.969806594, 0.969659159, 0.969511667, 0.969511667, 0.969364022, 0.969364022, 0.969216258,
                0.969068343, 0.968920351, 0.968772291, 0.968772291, 0.968624043, 0.968475778, 0.968327498, 0.968179149,
                0.968030784, 0.967882356, 0.967882356, 0.967733771, 0.96758498, 0.967436187, 0.967287403, 0.967287403,
                0.967138554, 0.966989689, 0.966840812, 0.966691942, 0.966543078, 0.966394154, 0.966245095, 0.966095981,
                0.965946816, 0.965797602, 0.965648227, 0.965498855, 0.965349408, 0.965349408, 0.965349408, 0.965199718,
                0.965050012, 0.965050012, 0.964900264, 0.964900264, 0.964750366, 0.964600352, 0.964450344, 0.964300261,
                0.964300261, 0.964149989, 0.963999688, 0.963849367, 0.963698908, 0.963548398, 0.963548398, 0.96339782,
                0.96339782, 0.963247188, 0.963096443, 0.963096443, 0.962945659, 0.962945659, 0.962945659, 0.962794662,
                0.962643638, 0.962492525, 0.962492525, 0.962341371, 0.962190203, 0.962039023, 0.961887771, 0.961736518,
                0.961585269, 0.961585269, 0.961433927, 0.961433927, 0.961282421, 0.961130891, 0.960979285, 0.960979285,
                0.960827614, 0.960675856, 0.960524041, 0.960524041, 0.960524041, 0.960372039, 0.960219955, 0.960219955,
                0.96006774, 0.959915468, 0.959763116, 0.959610664, 0.959458171, 0.959458171, 0.959305516, 0.959305516,
                0.959152768, 0.959152768, 0.958999926, 0.958847066, 0.958694091, 0.958541094, 0.958388101, 0.958388101,
                0.958234856, 0.958234856, 0.958081437, 0.958081437, 0.957927899, 0.957774117, 0.957774117, 0.957774117,
                0.95762008, 0.957466054, 0.957466054, 0.957311767, 0.957157467, 0.957003047, 0.956848629, 0.95669398,
                0.956539186, 0.956539186, 0.956539186, 0.956384152, 0.956384152, 0.956228946, 0.956073689, 0.955918444,
                0.955763108, 0.955607463, 0.955607463, 0.955451746, 0.95529599, 0.95529599, 0.95529599, 0.955139997,
                0.954983898, 0.954983898, 0.954983898, 0.954827682, 0.95467124, 0.95467124, 0.95467124, 0.954514566,
                0.954357871, 0.954201081, 0.954044289, 0.953887436, 0.953730557, 0.953573636, 0.953573636, 0.953416489,
                0.953416489, 0.953259332, 0.953102147, 0.95294493, 0.95294493, 0.952787098, 0.952787098, 0.952787098,
                0.95262901, 0.952470904, 0.952470904, 0.952312712, 0.952154381, 0.952154381, 0.951995979, 0.951837124,
                0.951678243, 0.951519262, 0.951360094, 0.951200825, 0.951041322, 0.951041322, 0.950881796, 0.950722283,
                0.950562708, 0.950403016, 0.950243224, 0.950083389, 0.949923468, 0.949763514, 0.949603492, 0.949443324,
                0.949283138, 0.949283138, 0.949122859, 0.948962447, 0.948962447, 0.948962447, 0.948801463, 0.948801463,
                0.948801463, 0.948801463, 0.948640018, 0.9484783, 0.948316452, 0.948154508, 0.947992378, 0.947830268,
                0.947668157, 0.947506027, 0.947343857, 0.947181604, 0.947181604, 0.947181604, 0.947019218, 0.946856719,
                0.946694133, 0.946531507, 0.946368822, 0.946206111, 0.946206111, 0.946043173, 0.945880246, 0.945880246,
                0.945717253, 0.945554279, 0.945391222, 0.945391222, 0.945391222, 0.94522795, 0.94522795, 0.94506463,
                0.94506463, 0.944901254, 0.944737448, 0.944737448, 0.944737448, 0.944573344, 0.944409121, 0.944244735,
                0.944080355, 0.944080355, 0.943915684, 0.943750882, 0.943586066, 0.943421226, 0.94325639, 0.94325639,
                0.943091276, 0.94292615, 0.94276104, 0.94276104, 0.942595815, 0.942430592, 0.942265238, 0.942265238,
                0.942265238, 0.942265238, 0.942098959, 0.941932557, 0.941765837, 0.941599089, 0.941432347, 0.941432347,
                0.941265422, 0.94109848, 0.940931478, 0.94076443, 0.94059739, 0.940430182, 0.940430182, 0.94026287,
                0.940095474, 0.940095474, 0.939927979, 0.939760479, 0.939592951, 0.939592951, 0.939592951, 0.939425277,
                0.939257533, 0.939089674, 0.939089674, 0.938921714, 0.938753565, 0.938753565, 0.938585394, 0.938585394,
                0.938417032, 0.938248634, 0.938248634, 0.938079961, 0.938079961, 0.938079961, 0.938079961, 0.937911071,
                0.937742136, 0.937742136, 0.93757305, 0.937403973, 0.937403973, 0.937234802, 0.937234802, 0.937065446,
                0.937065446, 0.936895925, 0.936895925, 0.936726281, 0.936556554, 0.936556554, 0.936556554, 0.936556554,
                0.936556554, 0.936386333, 0.936386333, 0.936215834, 0.936215834, 0.936045215, 0.936045215, 0.936045215,
                0.935874349, 0.935703428, 0.935532411, 0.935361239, 0.935361239, 0.93518953, 0.935017742, 0.934845766,
                0.9346738, 0.934501798, 0.934501798, 0.934329615, 0.934157337, 0.933984956, 0.93381257, 0.93381257,
                0.933640143, 0.933467678, 0.93329518, 0.933122656, 0.932950062, 0.932777266, 0.932604444, 0.932431572,
                0.93225867, 0.932085681, 0.931912703, 0.931739719, 0.931739719, 0.931566341, 0.931392848, 0.931219264,
                0.931045673, 0.931045673, 0.930872022, 0.930698337, 0.930524646, 0.930350819, 0.930176954, 0.930003027,
                0.930003027, 0.930003027, 0.930003027, 0.929828639, 0.929828639, 0.929828639, 0.929828639, 0.929652749,
                0.929652749, 0.929476694, 0.929476694, 0.929476694, 0.929300451, 0.929124189, 0.928947889, 0.928771582,
                0.928595204, 0.928418663, 0.928242028, 0.928242028, 0.928065115, 0.927888069, 0.927888069, 0.92771081,
                0.927533551, 0.927356318, 0.927179096, 0.927001895, 0.926824608, 0.926646967, 0.926469337, 0.926469337,
                0.92629152, 0.926113674, 0.925935725, 0.925757649, 0.925757649, 0.925578986, 0.925400302, 0.925221537,
                0.925042706, 0.924863552, 0.924684358, 0.924684358, 0.924504938, 0.924325533, 0.924146117, 0.923966608,
                0.923787088, 0.923607551, 0.923427979, 0.9232484, 0.9232484, 0.92306866, 0.922888846, 0.922888846,
                0.922708672, 0.922528268, 0.922347876, 0.922167375, 0.922167375, 0.921986856, 0.921806159, 0.921806159,
                0.921806159, 0.92162507, 0.92162507, 0.92162507, 0.92162507, 0.92162507, 0.921443234, 0.921261361,
                0.921079197, 0.921079197, 0.920896783, 0.920896783, 0.920896783, 0.920896783, 0.920713653, 0.920713653,
                0.920713653, 0.920530377, 0.920346958, 0.920346958, 0.920346958, 0.920346958, 0.920163166, 0.920163166,
                0.919979081, 0.919795018, 0.919795018, 0.919609774, 0.919609774, 0.919424428, 0.919239076, 0.919053671,
                0.918868201, 0.918682752, 0.918682752, 0.918682752, 0.918682752, 0.918682752, 0.918497039, 0.918497039,
                0.918497039, 0.918497039, 0.918497039, 0.9183108, 0.91812455, 0.91812455, 0.91812455, 0.917937621,
                0.917750694, 0.917563749, 0.917376753, 0.917189711, 0.917189711, 0.917002559, 0.917002559, 0.916815366,
                0.916815366, 0.916815366, 0.916627824, 0.916627824, 0.916440088, 0.916252234, 0.916064351, 0.916064351,
                0.915876269, 0.915876269, 0.915688078, 0.915688078, 0.915499827, 0.915311568, 0.915123275, 0.915123275,
                0.915123275, 0.914934867, 0.914746463, 0.914558022, 0.914369586, 0.914369586, 0.914180977, 0.913992315,
                0.913803603, 0.913614851, 0.913426069, 0.913426069, 0.913237126, 0.913237126, 0.913047569, 0.912857865,
                0.912857865, 0.91266803, 0.91266803, 0.91266803, 0.912477752, 0.912287388, 0.912096627, 0.911905882,
                0.911714997, 0.911714997, 0.911714997, 0.911714997, 0.911524024, 0.911332997, 0.911141857, 0.911141857,
                0.910950685, 0.910759508, 0.910759508, 0.910568264, 0.910568264, 0.910568264, 0.910568264, 0.910376674,
                0.910184975, 0.909993113, 0.909993113, 0.909800823, 0.909608489, 0.909416163, 0.909223778, 0.909031271,
                0.908838765, 0.908646183, 0.908453521, 0.908453521, 0.908453521, 0.908260642, 0.908260642, 0.908067664,
                0.907874683, 0.907681695, 0.907488697, 0.907295651, 0.907102553, 0.906909453, 0.906716241, 0.906523016,
                0.906523016, 0.90632935, 0.90632935, 0.906135437, 0.906135437, 0.90594136, 0.90594136, 0.905746952,
                0.905552539, 0.905358072, 0.905358072, 0.905358072, 0.905163472, 0.904968846, 0.904774128, 0.904579394,
                0.904579394, 0.9043846, 0.904189751, 0.903994798, 0.903799878, 0.903604956, 0.903409939, 0.903409939,
                0.903409939, 0.903409939, 0.903409939, 0.903213881, 0.903017815, 0.903017815, 0.903017815, 0.902820915,
                0.902820915, 0.902624009, 0.902427131, 0.902230219, 0.902230219, 0.902230219, 0.902033088, 0.901835698,
                0.901638213, 0.901440706, 0.901243196, 0.901045538, 0.900847777, 0.900649884, 0.900452019, 0.900452019,
                0.900254121, 0.900254121, 0.900055613, 0.900055613, 0.899857064, 0.89965846, 0.89965846, 0.89965846,
                0.89965846, 0.899459566, 0.899260645, 0.899260645, 0.899061532, 0.898862287, 0.898662896, 0.898463488,
                0.898264076, 0.898264076, 0.898264076, 0.898064172, 0.897864135, 0.897663991, 0.897463781, 0.897263576,
                0.897263576, 0.897063234, 0.896862904, 0.896862904, 0.896862904, 0.896662148, 0.896662148, 0.896461137,
                0.896260064, 0.896058867, 0.895857675, 0.895857675, 0.895656406, 0.895656406, 0.895455126, 0.895253674,
                0.895052019, 0.894850224, 0.894850224, 0.894648221, 0.894446117, 0.894243613, 0.894243613, 0.894040779,
                0.893837918, 0.893634982, 0.893431979, 0.89322866, 0.893025341, 0.893025341, 0.893025341, 0.893025341,
                0.892821584, 0.892821584, 0.892617657, 0.89241359, 0.892209494, 0.892005322, 0.891801121, 0.891596892,
                0.891596892, 0.891392109, 0.891392109, 0.891187281, 0.890982391, 0.890982391, 0.890777347, 0.890572209,
                0.890572209, 0.890366852, 0.890161347, 0.890161347, 0.889955602, 0.889955602, 0.889749803, 0.889749803,
                0.889543939, 0.889543939, 0.889337758, 0.889337758, 0.889131262, 0.888924724, 0.888924724, 0.888717971,
                0.888511135, 0.888511135, 0.888304099, 0.888097049, 0.887890021, 0.887683001, 0.887475902, 0.887268644,
                0.887268644, 0.887060923, 0.886852859, 0.886644717, 0.886644717, 0.886436368, 0.886227689, 0.886018586,
                0.885809417, 0.885600209, 0.885390993, 0.885390993, 0.885390993, 0.885390993, 0.885390993, 0.885390993,
                0.885181294, 0.884971544, 0.884971544, 0.884761771, 0.884551852, 0.884341684, 0.884131463, 0.884131463,
                0.884131463, 0.883920966, 0.883920966, 0.883710289, 0.883499612, 0.883288923, 0.883288923, 0.883288923,
                0.883077797, 0.882866575, 0.882655217, 0.882655217, 0.882655217, 0.882443692, 0.882443692, 0.882232127,
                0.882020582, 0.881809046, 0.881809046, 0.881597278, 0.881597278, 0.881597278, 0.881597278, 0.881385332,
                0.881385332, 0.881173244, 0.881173244, 0.880960961, 0.880748449, 0.880535932, 0.880323455, 0.880323455,
                0.880110897, 0.879898298, 0.879685403, 0.879472504, 0.879259551, 0.879046597, 0.879046597, 0.878833583,
                0.878620435, 0.878620435, 0.878407089, 0.878193528, 0.87797989, 0.87797989, 0.877766106, 0.877766106,
                0.877552255, 0.877338394, 0.877124474, 0.876910584, 0.876910584, 0.876696386, 0.876482236, 0.876482236,
                0.876267949, 0.876267949, 0.876267949, 0.876052993, 0.876052993, 0.876052993, 0.875837798, 0.875622469,
                0.875406998, 0.87519146, 0.874975701, 0.8747599, 0.8747599, 0.874543657, 0.874543657, 0.874543657,
                0.874327144, 0.874327144, 0.874327144, 0.874110084, 0.873892955, 0.873675807, 0.873458517, 0.873458517,
                0.873240987, 0.873240987, 0.873023302, 0.872805522, 0.872587648, 0.872587648, 0.872587648, 0.872587648,
                0.872368834, 0.872150049, 0.872150049, 0.872150049, 0.871931106, 0.871712197, 0.871712197, 0.871493218,
                0.871274064, 0.871054596, 0.871054596, 0.8708348, 0.8708348, 0.870614949, 0.870614949, 0.870394773,
                0.870174574, 0.869954291, 0.869954291, 0.86973362, 0.869512979, 0.869512979, 0.86929231, 0.869071343,
                0.868850261, 0.86862915, 0.868407512, 0.868185836, 0.867964037, 0.867742082, 0.867520172, 0.867298213,
                0.867298213, 0.867298213, 0.867075628, 0.866852697, 0.866852697, 0.866629677, 0.866406566, 0.866183424,
                0.866183424, 0.865960023, 0.865960023, 0.865960023, 0.865736148, 0.865736148, 0.865736148, 0.865512062,
                0.865512062, 0.865512062, 0.865287049, 0.865062002, 0.864836735, 0.864611487, 0.864611487, 0.864385729,
                0.864385729, 0.864385729, 0.86415976, 0.863933685, 0.863707555, 0.86348119, 0.863254855, 0.863254855,
                0.863254855, 0.863028284, 0.862801682, 0.862575048, 0.862575048, 0.862347989, 0.86212096, 0.861893882,
                0.861666802, 0.861439573, 0.861212112, 0.861212112, 0.861212112, 0.861212112, 0.861212112, 0.861212112,
                0.861212112, 0.860982893, 0.860753706, 0.860524541, 0.860295372, 0.860295372, 0.860065978, 0.860065978,
                0.859836596, 0.859607114, 0.859377453, 0.859147699, 0.859147699, 0.859147699, 0.858917365, 0.858687072,
                0.858456798, 0.858226511, 0.858226511, 0.858226511, 0.858226511, 0.858226511, 0.857995176, 0.857995176,
                0.857995176, 0.857995176, 0.857763435, 0.857763435, 0.857531462, 0.857531462, 0.857299304, 0.857299304,
                0.857299304, 0.857066579, 0.85683364, 0.85683364, 0.856600282, 0.856600282, 0.856600282, 0.856366617,
                0.856366617, 0.856366617, 0.856132586, 0.856132586, 0.855898226, 0.85566377, 0.855429129, 0.855194455,
                0.855194455, 0.854959606, 0.854959606, 0.854724719, 0.854489206, 0.854253516, 0.854017711, 0.853781849,
                0.853545799, 0.853545799, 0.853309622, 0.853073431, 0.852837286, 0.852600667, 0.852363798, 0.852363798,
                0.852363798, 0.852126598, 0.852126598, 0.851889371, 0.851889371, 0.851652044, 0.851414353, 0.851414353,
                0.851414353, 0.85117647, 0.850938153, 0.850699695, 0.850460943, 0.850222188, 0.850222188, 0.850222188,
                0.850222188, 0.850222188, 0.849982036, 0.849982036, 0.849982036, 0.849740747, 0.849499468, 0.849499468,
                0.849257957, 0.849016442, 0.848774496, 0.848774496, 0.848774496, 0.848531656, 0.848288833, 0.848045654,
                0.848045654, 0.847802116, 0.847802116, 0.847802116, 0.84755819, 0.84731423, 0.84731423, 0.84731423,
                0.847070074, 0.846825718, 0.846825718, 0.846581211, 0.846336635, 0.846336635, 0.846091775, 0.845846899,
                0.845601658, 0.845356466, 0.845356466, 0.845110502, 0.844864403, 0.844618154, 0.844371932, 0.844125718,
                0.844125718, 0.843879323, 0.843879323, 0.843632735, 0.843386015, 0.84313927, 0.842892503, 0.842645168,
                0.842397757, 0.842397757, 0.842397757, 0.842149869, 0.842149869, 0.842149869, 0.841901255, 0.841901255,
                0.841901255, 0.841651628, 0.841651628, 0.8414013, 0.841150794, 0.840899408, 0.840647476, 0.840395289,
                0.840142876, 0.839890232, 0.839890232, 0.839890232, 0.839890232, 0.83963548, 0.83963548, 0.839380292,
                0.839380292, 0.839124777, 0.838869302, 0.838869302, 0.838869302, 0.838869302, 0.838612298, 0.838354766,
                0.838354766, 0.838354766, 0.838354766, 0.838095497, 0.838095497, 0.837835339, 0.837835339, 0.837574313,
                0.837574313, 0.837312793, 0.837312793, 0.837312793, 0.837312793
            }
            Dim J As Vector = {
                1, 0.999874446, 0.999748865, 0.999748865, 0.999748865, 0.999623134, 0.999623134, 0.999623134,
                0.999497251, 0.999371268, 0.999371268, 0.9992452, 0.9992452, 0.999119087, 0.998992881, 0.998992881,
                0.998992881, 0.998992881, 0.998992881, 0.998866203, 0.998739535, 0.998739535, 0.998739535, 0.998739535,
                0.998739535, 0.998739535, 0.998739535, 0.998612524, 0.998485376, 0.998485376, 0.998485376, 0.998485376,
                0.998485376, 0.998357988, 0.998357988, 0.998230522, 0.998230522, 0.998230522, 0.99810285, 0.997974895,
                0.997846947, 0.997846947, 0.997846947, 0.997846947, 0.997846947, 0.997846947, 0.997718564, 0.997718564,
                0.997718564, 0.997718564, 0.997718564, 0.997718564, 0.997718564, 0.997718564, 0.997718564, 0.997718564,
                0.997718564, 0.997588854, 0.997459127, 0.997459127, 0.997459127, 0.997459127, 0.997459127, 0.997328722,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313,
                0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997198313, 0.997064238, 0.997064238, 0.997064238,
                0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238,
                0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.997064238, 0.996929035,
                0.996929035, 0.996929035, 0.996793696, 0.996793696, 0.996658004, 0.996522198, 0.996522198, 0.996522198,
                0.996522198, 0.996522198, 0.996522198, 0.996385463, 0.996385463, 0.996385463, 0.996385463, 0.996385463,
                0.996385463, 0.996385463, 0.996385463, 0.996248477, 0.996248477, 0.996248477, 0.996248477, 0.996111222,
                0.996111222, 0.996111222, 0.996111222, 0.996111222, 0.996111222, 0.996111222, 0.996111222, 0.99597303,
                0.995834834, 0.995696584, 0.995558221, 0.995558221, 0.995558221, 0.995558221, 0.995558221, 0.995558221,
                0.995558221, 0.995558221, 0.995558221, 0.995558221, 0.995558221, 0.995418982, 0.995279727, 0.995140439,
                0.995140439, 0.995001025, 0.995001025, 0.995001025, 0.995001025, 0.995001025, 0.995001025, 0.995001025,
                0.995001025, 0.995001025, 0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994861076,
                0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994861076, 0.994720088,
                0.994579115, 0.994579115, 0.994579115, 0.994437815, 0.994437815, 0.994296454, 0.994296454, 0.9941548,
                0.9941548, 0.9941548, 0.994012805, 0.994012805, 0.994012805, 0.994012805, 0.993870559, 0.993870559,
                0.993870559, 0.993870559, 0.993727889, 0.993727889, 0.993727889, 0.993727889, 0.993727889, 0.993727889,
                0.993727889, 0.99358467, 0.99358467, 0.99358467, 0.99358467, 0.99358467, 0.99358467, 0.99358467,
                0.993440487, 0.993440487, 0.993440487, 0.993440487, 0.993440487, 0.993296187, 0.993296187, 0.993296187,
                0.993151759, 0.993151759, 0.993007258, 0.992862583, 0.992862583, 0.992862583, 0.992862583, 0.992862583,
                0.992862583, 0.992717442, 0.992571828, 0.992571828, 0.992571828, 0.992571828, 0.992571828, 0.992425943,
                0.992425943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943,
                0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992279943, 0.992133146,
                0.992133146, 0.992133146, 0.992133146, 0.991986093, 0.991838991, 0.991838991, 0.991838991, 0.991838991,
                0.991838991, 0.991838991, 0.991838991, 0.991691343, 0.991691343, 0.991543489, 0.991543489, 0.991543489,
                0.991543489, 0.991543489, 0.991395157, 0.991395157, 0.991395157, 0.991395157, 0.991395157, 0.991395157,
                0.991395157, 0.99124619, 0.99124619, 0.99124619, 0.99124619, 0.99124619, 0.991096646, 0.991096646,
                0.991096646, 0.991096646, 0.991096646, 0.991096646, 0.991096646, 0.991096646, 0.991096646, 0.991096646,
                0.991096646, 0.991096646, 0.991096646, 0.991096646, 0.990946141, 0.990795565, 0.990795565, 0.990795565,
                0.990644811, 0.990644811, 0.990494032, 0.990494032, 0.990494032, 0.990494032, 0.990494032, 0.990342859,
                0.990342859, 0.990342859, 0.990342859, 0.990342859, 0.990342859, 0.990191349, 0.990191349, 0.990039739,
                0.990039739, 0.990039739, 0.989887945, 0.989887945, 0.989736103, 0.989584273, 0.989584273, 0.989584273,
                0.989584273, 0.989432141, 0.989432141, 0.989432141, 0.989432141, 0.989432141, 0.989432141, 0.989432141,
                0.989279712, 0.989279712, 0.989127204, 0.989127204, 0.989127204, 0.989127204, 0.988974423, 0.988974423,
                0.988974423, 0.988974423, 0.988821336, 0.988668143, 0.988668143, 0.988668143, 0.988514805, 0.988514805,
                0.988514805, 0.988514805, 0.988514805, 0.988514805, 0.988360876, 0.988360876, 0.988206737, 0.988206737,
                0.988052415, 0.988052415, 0.988052415, 0.988052415, 0.988052415, 0.988052415, 0.987897673, 0.987897673,
                0.987742785, 0.987742785, 0.987587711, 0.987587711, 0.987587711, 0.987431977, 0.987276179, 0.987276179,
                0.987276179, 0.987120078, 0.987120078, 0.987120078, 0.987120078, 0.987120078, 0.987120078, 0.987120078,
                0.986963378, 0.986806671, 0.986806671, 0.986649751, 0.986649751, 0.986649751, 0.986649751, 0.986649751,
                0.986649751, 0.986491864, 0.986491864, 0.986491864, 0.986333708, 0.986175447, 0.986175447, 0.986175447,
                0.986016981, 0.985858436, 0.985858436, 0.985858436, 0.985699689, 0.985540838, 0.985540838, 0.985540838,
                0.985540838, 0.985540838, 0.985540838, 0.985540838, 0.985540838, 0.98538154, 0.98538154, 0.985222124,
                0.985222124, 0.985222124, 0.985222124, 0.985062358, 0.985062358, 0.984902366, 0.984742339, 0.984742339,
                0.984742339, 0.984582229, 0.984582229, 0.984582229, 0.984421909, 0.984421909, 0.984421909, 0.984421909,
                0.984421909, 0.984421909, 0.984421909, 0.984421909, 0.984259986, 0.984259986, 0.984259986, 0.984259986,
                0.984259986, 0.984259986, 0.984259986, 0.984259986, 0.984259986, 0.984259986, 0.984259986, 0.984259986,
                0.98409695, 0.98409695, 0.98409695, 0.983933535, 0.98376996, 0.98376996, 0.983606107, 0.983442194,
                0.983278228, 0.983278228, 0.983278228, 0.983278228, 0.983278228, 0.983278228, 0.983278228, 0.983278228,
                0.983278228, 0.983278228, 0.983278228, 0.983113004, 0.982947774, 0.982947774, 0.982947774, 0.982947774,
                0.982947774, 0.982947774, 0.982947774, 0.982781856, 0.982781856, 0.982781856, 0.982615818, 0.982615818,
                0.982615818, 0.982615818, 0.982449571, 0.982283314, 0.982283314, 0.982116959, 0.982116959, 0.981950557,
                0.981950557, 0.981950557, 0.981783809, 0.981616841, 0.981616841, 0.981616841, 0.981616841, 0.981616841,
                0.981449099, 0.981449099, 0.981449099, 0.981449099, 0.981449099, 0.981449099, 0.981280862, 0.981280862,
                0.981280862, 0.981280862, 0.98111221, 0.98111221, 0.98111221, 0.98111221, 0.980943124, 0.980773928,
                0.980604674, 0.980604674, 0.980604674, 0.980604674, 0.980604674, 0.980604674, 0.980434768, 0.980434768,
                0.980434768, 0.980434768, 0.980434768, 0.980434768, 0.980434768, 0.980264418, 0.980264418, 0.980264418,
                0.980093896, 0.980093896, 0.980093896, 0.980093896, 0.979923115, 0.979752338, 0.979752338, 0.979752338,
                0.979752338, 0.97958123, 0.97958123, 0.97958123, 0.979409962, 0.979409962, 0.979238546, 0.979238546,
                0.979238546, 0.979066823, 0.979066823, 0.978894732, 0.978722655, 0.978550582, 0.978550582, 0.978550582,
                0.978378325, 0.978378325, 0.978378325, 0.978206037, 0.978206037, 0.978033489, 0.978033489, 0.977860739,
                0.977860739, 0.977687929, 0.977687929, 0.977687929, 0.977514828, 0.977341681, 0.977168541, 0.976995316,
                0.976995316, 0.976821653, 0.976821653, 0.976647876, 0.976647876, 0.976473881, 0.976299881, 0.976299881,
                0.976299881, 0.976299881, 0.976299881, 0.97612507, 0.97612507, 0.97612507, 0.97612507, 0.97612507,
                0.97612507, 0.975949811, 0.975949811, 0.975949811, 0.975949811, 0.975949811, 0.975774192, 0.975774192,
                0.975774192, 0.975774192, 0.975774192, 0.975774192, 0.975774192, 0.975774192, 0.975774192, 0.975774192,
                0.975774192, 0.975774192, 0.975774192, 0.975597025, 0.975597025, 0.975597025, 0.975597025, 0.975597025,
                0.975419464, 0.975419464, 0.975419464, 0.975419464, 0.975419464, 0.975419464, 0.975419464, 0.975241279,
                0.97506285, 0.974884412, 0.974884412, 0.974705183, 0.974525779, 0.974346036, 0.974346036, 0.974166058,
                0.974166058, 0.973985978, 0.973805892, 0.973805892, 0.973805892, 0.973805892, 0.973805892, 0.973805892,
                0.973805892, 0.973805892, 0.973624804, 0.973624804, 0.973624804, 0.973443533, 0.973443533, 0.973443533,
                0.973443533, 0.973443533, 0.973443533, 0.973443533, 0.973443533, 0.973443533, 0.973261196, 0.973261196,
                0.973261196, 0.973261196, 0.973261196, 0.973077915, 0.973077915, 0.973077915, 0.973077915, 0.973077915,
                0.973077915, 0.973077915, 0.972893467, 0.972893467, 0.972893467, 0.972893467, 0.972893467, 0.972893467,
                0.972893467, 0.972893467, 0.972893467, 0.972708531, 0.972708531, 0.972708531, 0.972523005, 0.972523005,
                0.972523005, 0.972523005, 0.972523005, 0.972337159, 0.972337159, 0.972337159, 0.972151053, 0.971964795,
                0.971964795, 0.971778277, 0.97159176, 0.971405055, 0.97121817, 0.97121817, 0.97121817, 0.97121817,
                0.971030539, 0.971030539, 0.970842602, 0.970654352, 0.970466015, 0.970466015, 0.970277437, 0.970088742,
                0.970088742, 0.970088742, 0.969899877, 0.969710995, 0.969522042, 0.969522042, 0.969332687, 0.969332687,
                0.969332687, 0.96914297, 0.96914297, 0.968952631, 0.968952631, 0.968952631, 0.968952631, 0.968952631,
                0.968952631, 0.968761902, 0.968571196, 0.968380452, 0.968189699, 0.968189699, 0.96799888, 0.967808063,
                0.967617117, 0.96742616, 0.96742616, 0.96742616, 0.967234784, 0.967043239, 0.967043239, 0.967043239,
                0.967043239, 0.967043239, 0.967043239, 0.966851234, 0.966851234, 0.966659048, 0.966659048, 0.966466853,
                0.966274658, 0.966274658, 0.96608215, 0.96608215, 0.96608215, 0.96608215, 0.965889231, 0.965889231,
                0.965696071, 0.965696071, 0.965502857, 0.965502857, 0.965502857, 0.965502857, 0.965309494, 0.965116135,
                0.965116135, 0.965116135, 0.965116135, 0.965116135, 0.964922428, 0.964922428, 0.964922428, 0.964922428,
                0.964922428, 0.964922428, 0.964728309, 0.964728309, 0.964534053, 0.964534053, 0.964534053, 0.964339069,
                0.964339069, 0.964143914, 0.963948478, 0.963948478, 0.963948478, 0.963948478, 0.963948478, 0.963948478,
                0.963751942, 0.963555389, 0.963358867, 0.963358867, 0.963358867, 0.963358867, 0.963162087, 0.963162087,
                0.963162087, 0.962965283, 0.962965283, 0.962768304, 0.962571324, 0.96237436, 0.96237436, 0.96237436,
                0.96237436, 0.96217668, 0.96217668, 0.96217668, 0.96217668, 0.96217668, 0.96217668, 0.96217668,
                0.96217668, 0.96217668, 0.961977764, 0.961778794, 0.961778794, 0.961579764, 0.961579764, 0.961579764,
                0.961579764, 0.961579764, 0.961579764, 0.961579764, 0.961579764, 0.961579764, 0.961579764, 0.961379915,
                0.961379915, 0.961179561, 0.961179561, 0.960979108, 0.960979108, 0.96077856, 0.96077856, 0.96077856,
                0.96077856, 0.960577673, 0.960376757, 0.960376757, 0.960376757, 0.960376757, 0.960376757, 0.960175407,
                0.960175407, 0.960175407, 0.960175407, 0.960175407, 0.960175407, 0.960175407, 0.959973554, 0.959771348,
                0.959569041, 0.95936666, 0.95936666, 0.95936666, 0.959163843, 0.958960561, 0.958960561, 0.958757238,
                0.958757238, 0.958757238, 0.958757238, 0.958553777, 0.958350338, 0.958350338, 0.958350338, 0.958350338,
                0.958350338, 0.958350338, 0.958350338, 0.958350338, 0.958350338, 0.958350338, 0.95814574, 0.95814574,
                0.95794059, 0.95794059, 0.957735439, 0.957735439, 0.957735439, 0.957529917, 0.957324365, 0.957118848,
                0.957118848, 0.957118848, 0.956913216, 0.956913216, 0.956913216, 0.956913216, 0.956913216, 0.956913216,
                0.956706761, 0.956500284, 0.956500284, 0.956500284, 0.956500284, 0.956500284, 0.956500284, 0.956293226,
                0.956293226, 0.956293226, 0.956086006, 0.955878548, 0.955878548, 0.955670863, 0.955670863, 0.955670863,
                0.955670863, 0.955670863, 0.955462751, 0.955462751, 0.955254592, 0.955254592, 0.955254592, 0.955254592,
                0.955254592, 0.955045911, 0.955045911, 0.955045911, 0.955045911, 0.954836577, 0.954836577, 0.954836577,
                0.954836577, 0.954836577, 0.954836577, 0.954836577, 0.954626638, 0.95441644, 0.954206227, 0.954206227,
                0.953995819, 0.953995819, 0.953995819, 0.953995819, 0.953995819, 0.953995819, 0.953995819, 0.953784317,
                0.953784317, 0.953572696, 0.953572696, 0.953572696, 0.953360938, 0.953360938, 0.953360938, 0.95314887,
                0.95314887, 0.95314887, 0.952936483, 0.952936483, 0.952723837, 0.952723837, 0.952511053, 0.952511053,
                0.952298089, 0.952298089, 0.952084634, 0.952084634, 0.952084634, 0.951870849, 0.951870849, 0.951870849,
                0.951656776, 0.951656776, 0.951656776, 0.951656776, 0.951656776, 0.951656776, 0.951656776, 0.951441981,
                0.951441981, 0.951441981, 0.951441981, 0.951226288, 0.951226288, 0.951226288, 0.951226288, 0.951226288,
                0.951226288, 0.951226288, 0.951009621, 0.950792957, 0.950576114, 0.950359254, 0.950142322, 0.950142322,
                0.950142322, 0.949925312, 0.949925312, 0.949925312, 0.949925312, 0.949925312, 0.949707415, 0.94948938,
                0.94948938, 0.949271356, 0.949271356, 0.949271356, 0.949271356, 0.949053037, 0.948834718, 0.948834718,
                0.948834718, 0.948834718, 0.948616045, 0.948397409, 0.948397409, 0.948178589, 0.948178589, 0.948178589,
                0.948178589, 0.947959579, 0.947959579, 0.947740406, 0.947521175, 0.947301961, 0.947301961, 0.947082717,
                0.947082717, 0.946863079, 0.946863079, 0.946863079, 0.946863079, 0.946863079, 0.946642963, 0.946642963,
                0.946642963, 0.946642963, 0.946642963, 0.946642963, 0.946642963, 0.946422233, 0.946422233, 0.946422233,
                0.946201141, 0.946201141, 0.946201141, 0.946201141, 0.945979522, 0.945979522, 0.945757694, 0.945757694,
                0.945757694, 0.945757694, 0.945757694, 0.945535184, 0.945535184, 0.945535184, 0.945312586, 0.945312586,
                0.945089327, 0.94486593, 0.94486593, 0.944642371, 0.944418737, 0.944418737, 0.944418737, 0.944418737,
                0.944418737, 0.944418737, 0.944418737, 0.944194267, 0.944194267, 0.943969634, 0.943744828, 0.943744828,
                0.943519825, 0.94329444, 0.94329444, 0.94329444, 0.94329444, 0.94329444, 0.943068292, 0.943068292,
                0.942841957, 0.942841957, 0.942841957, 0.942841957, 0.942615177, 0.942387889, 0.942160388, 0.942160388,
                0.942160388, 0.941932711, 0.941705059, 0.941705059, 0.941705059, 0.941477211, 0.941477211, 0.941477211,
                0.941477211, 0.941248607, 0.941248607, 0.941019614, 0.941019614, 0.940790577, 0.940790577, 0.940790577,
                0.940790577, 0.940560597, 0.940560597, 0.940560597, 0.940330397, 0.940330397, 0.940330397, 0.940330397,
                0.940330397, 0.940330397, 0.940330397, 0.940330397, 0.940330397, 0.940330397, 0.940330397, 0.940098494,
                0.939866316, 0.939866316, 0.939866316, 0.93963297, 0.93963297, 0.93963297, 0.93963297, 0.939399298,
                0.939399298, 0.939165569, 0.938931807, 0.938931807, 0.938697558, 0.938463329, 0.938463329, 0.938228524,
                0.937993214, 0.937993214, 0.937993214, 0.937993214, 0.937993214, 0.937757176, 0.937757176, 0.937521102,
                0.93728504, 0.93728504, 0.93728504, 0.93728504, 0.93728504, 0.93728504, 0.937048371, 0.936811724,
                0.936811724, 0.936811724, 0.936811724, 0.936574582, 0.936574582, 0.936574582, 0.936574582, 0.936574582,
                0.936574582, 0.936574582, 0.936336544, 0.936098525, 0.935860329, 0.935621421, 0.935382522, 0.935143483,
                0.935143483, 0.935143483, 0.935143483, 0.935143483, 0.934904165, 0.934904165, 0.934664771, 0.934664771,
                0.934664771, 0.934664771, 0.934664771, 0.934424598, 0.934184058, 0.934184058, 0.934184058, 0.934184058,
                0.934184058, 0.933943239, 0.933702435, 0.933461504, 0.933220601, 0.933220601, 0.932979085, 0.932737521,
                0.932495844, 0.932495844, 0.932254008, 0.932254008, 0.932011803, 0.932011803, 0.931769433, 0.931526992,
                0.931526992, 0.931526992, 0.931284152, 0.931284152, 0.93104114, 0.930797877, 0.930797877, 0.93055433,
                0.93031076, 0.93031076, 0.930066837, 0.930066837, 0.930066837, 0.930066837, 0.930066837, 0.929821942,
                0.929821942, 0.929576968, 0.929576968, 0.929576968, 0.929576968, 0.929576968, 0.929576968, 0.929576968,
                0.929330349, 0.929330349, 0.929330349, 0.929330349, 0.929330349, 0.929330349, 0.929082907, 0.92883534,
                0.92883534, 0.928587653, 0.928587653, 0.928339838, 0.928339838, 0.928339838, 0.928091251, 0.927842361,
                0.927842361, 0.927842361, 0.927842361, 0.927842361, 0.927842361, 0.927591611, 0.927340526, 0.927089402,
                0.926838164, 0.926838164, 0.926586073, 0.926333311, 0.926333311, 0.926333311, 0.926080172, 0.926080172,
                0.926080172, 0.926080172, 0.925825973, 0.92557159, 0.92557159, 0.92557159, 0.92557159, 0.925316333,
                0.925316333, 0.925060562, 0.924804746, 0.924804746, 0.924804746, 0.924548653, 0.924292574, 0.924292574,
                0.924292574, 0.924036176, 0.924036176, 0.924036176, 0.92377903, 0.92377903, 0.92377903, 0.92377903,
                0.92377903, 0.92352153, 0.92352153, 0.92352153, 0.92352153, 0.92352153, 0.92352153, 0.923263092,
                0.923263092, 0.923004562, 0.923004562, 0.923004562, 0.923004562, 0.923004562, 0.923004562, 0.923004562,
                0.922744784, 0.922484685, 0.922484685, 0.922224233, 0.92196328, 0.92196328, 0.921701842, 0.921439956,
                0.921439956, 0.921177434, 0.921177434, 0.921177434, 0.921177434, 0.921177434, 0.921177434, 0.921177434,
                0.921177434, 0.920910625, 0.920643427, 0.920376008, 0.920376008, 0.920107433, 0.920107433, 0.91983871,
                0.91983871, 0.91983871, 0.91956953, 0.919300087, 0.919029826, 0.919029826, 0.919029826, 0.918758565,
                0.918485908, 0.918213173, 0.918213173, 0.917939832, 0.917939832, 0.917665669, 0.917665669, 0.917391013,
                0.917391013, 0.917115523, 0.916840007, 0.916564237
            }

            Dim F As New Vector(1500)
            Dim G As New Vector(1500)
            Dim K As New Vector(1500)
            Dim M As New Vector(1500)
            Dim R2 = 0.34362
            Dim R3 = 2.63588
            Dim R4 = 1.8803
            Dim R5 = 1.12673
            Dim R6 = -0.90941
            Dim R7 = 0.59397
            Dim R8 = 0.5232
            Dim R9 = 0.68602
            Dim Q2 = If(isMale, 1, 0)
            Dim Q3 = Math.Log(age)
            Dim Q4 = Math.Log(systolicBp)
            Dim Q5 = Math.Log(cholesterol)
            Dim Q6 = Math.Log(hdl)
            Dim Q7 = If(smoker, 1, 0)
            Dim Q8 = If(treatedBp, 1, 0)
            Dim Q9 = If(diabetic, 1, 0)
            Dim S2 = Q2 * R2
            Dim S3 = Q3 * R3
            Dim S4 = Q4 * R4
            Dim S5 = Q5 * R5
            Dim S6 = Q6 * R6
            Dim S7 = Q7 * R7
            Dim S8 = Q8 * R8
            Dim S9 = Q9 * R9
            Dim S11 = S2 + S3 + S4 + S5 + S6 + S7 + S8 + S9
            Dim T2 = 0.48123
            Dim T3 = 3.39222
            Dim T4 = 1.39862
            Dim T5 = -0.00439
            Dim T6 = 0.16081
            Dim T7 = 0.99858
            Dim T8 = 0.19035
            Dim T9 = 0.49756
            Dim U2 = Q2 * T2
            Dim U3 = Q3 * T3
            Dim U4 = Q4 * T4
            Dim U5 = Q5 * T5
            Dim U6 = Q6 * T6
            Dim U7 = Q7 * T7
            Dim U8 = Q8 * T8
            Dim U9 = Q9 * T9
            Dim U11 = U2 + U3 + U4 + U5 + U6 + U7 + U8 + U9
            Dim W2 = 21.29326612
            Dim W5 = Math.Exp(S11 - W2)
            Dim X2 = 20.12840698
            Dim X5 = Math.Exp(U11 - X2)

            ' set F
            F($"0:{Math.Min(E.Length, F.Length) - 1}") = E ^ W5
            ' for(i = 0; i < E.Length && i < F.Length; i++) {
            '     F[i] = Math.Pow(E[i], W5);
            ' }

            ' set G
            G($"0:{E.Length - 1}") = E _
                .SlideWindows(slideWindowSize:=2) _
                .Select(Function(w)
                            Return Math.Log(w(0)) - Math.Log(w(1))
                        End Function) _
                .AsList
            ' for (i = 0; i + 1 < E.length; i++) {
            '     G[i] = Math.Log(E[i]) - Math.Log(E[i + 1]);
            ' }

            ' set K
            K($"0:{Math.Min(K.Length, J.Length) - 1}") = J ^ X5
            ' for (i = 0; i < K.length && i < J.length; i++) {
            '     K[i] = Math.Pow(J[i], X5);
            ' }

            ' set M
            M(0) = W5 * (-Math.Log(E(0)))
            M($"1:{ {M.Length, F.Length, K.Length, G.Length}.Min - 1 }") = F * K * W5 * G
            ' for (i = 0; i + 1 < M.length && i < F.length && i < K.length && i < G.length; i++) {
            '     M[i + 1] = F[i] * K[i] * W5 * G[i];
            ' }

            ' now we can calculate the risk values
            Dim fullRisk = Aggregate value As Double
                           In M
                           Where Not value.IsNaNImaginary
                           Into Sum(value)
            ' for (i = 0; i < M.length && !isNaN(M[i]); i++) {
            '     fullRisk = fullRisk + M[i];
            ' }

            Return Math.Round(100 * fullRisk)
        End Function

        ''' <summary>
        ''' Calculates the hard CVD risk which is the risk of coronary death, myocardial infarction and fatal or non-fatal
        ''' stroke.
        ''' </summary>
        ''' <param name="age#">age of the patient, in years.</param>
        ''' <param name="isMale">true if patient is male, false if female</param>
        ''' <param name="systolicBp#">systolic blood pressure</param>
        ''' <param name="cholesterol#">total cholesterol</param>
        ''' <param name="hdl#">high density lipoprotein</param>
        ''' <param name="smoker">true if patient smokes, false if not</param>
        ''' <param name="treatedBp">true if patient is taking medications to treat high blood pressure, false if not</param>
        ''' <param name="diabetic">true if patient is diabetic, false if not</param>
        ''' <returns>
        ''' A JSON object with the risk percentages in the form of:
        ''' 
        ''' ```json
        ''' {"risk"  -1.0, "optimalRisk": -1.0, "normalRisk": -1.0}
        ''' ```
        ''' 
        ''' Note that -1 means something went wrong, otherwise it will be the percent risk.
        ''' </returns>
        Public Function calculateHardRiskNoBmi(age#, isMale As Boolean, systolicBp#, cholesterol#, hdl#, smoker As Boolean, treatedBp As Boolean, diabetic As Boolean) As Score30
            Dim returnObj As New Score30 With {
                .risk = calculateHardRiskNoBmiInternal(age, isMale, systolicBp, cholesterol, hdl, smoker, treatedBp, diabetic),
                .optimalRisk = calculateHardRiskNoBmiInternal(age, isMale, 110, 160, 60, False, False, False),
                .normalRisk = calculateHardRiskNoBmiInternal(age, isMale, 125, 180, 45, False, False, False)
            }
            Return returnObj
        End Function

        Private Function calculateHardRiskNoBmiInternal(age#, isMale As Boolean, systolicBp#, cholesterol#, hdl#, smoker As Boolean, treatedBp As Boolean, diabetic As Boolean) As Double
            Dim E As Vector = {
                0.99989223, 0.99989223, 0.99989223, 0.9997844, 0.999676537, 0.999676537, 0.999568591,
                0.999568591, 0.999568591, 0.999460474, 0.999460474, 0.999352333, 0.999352333, 0.999352333, 0.999244022,
                0.999135647, 0.999027221, 0.998918678, 0.998918678, 0.998918678, 0.998810045, 0.998810045, 0.998701294,
                0.998592538, 0.998592538, 0.998592538, 0.99848344, 0.998374296, 0.998265086, 0.998265086, 0.998155839,
                0.998155839, 0.99804647, 0.99804647, 0.99804647, 0.99804647, 0.997936874, 0.997827233, 0.997717558,
                0.997717558, 0.997607689, 0.997497246, 0.997386721, 0.997276046, 0.997165328, 0.997054488, 0.996943489,
                0.996832339, 0.996832339, 0.996832339, 0.996720949, 0.996609432, 0.996497798, 0.996497798, 0.996497798,
                0.996386054, 0.996274187, 0.996162208, 0.996050183, 0.995938163, 0.995826068, 0.995713817, 0.995601373,
                0.995488809, 0.995376109, 0.995263343, 0.995150588, 0.995037182, 0.995037182, 0.99492377, 0.994810334,
                0.994696853, 0.994583373, 0.994583373, 0.994469691, 0.994469691, 0.994355653, 0.994355653, 0.994355653,
                0.994355653, 0.994241355, 0.99412703, 0.99401268, 0.993898284, 0.993898284, 0.993898284, 0.993783683,
                0.993668887, 0.99355398, 0.993439001, 0.993324005, 0.993324005, 0.993324005, 0.993324005, 0.993324005,
                0.993208547, 0.993092982, 0.992977392, 0.992861801, 0.992746193, 0.992630573, 0.992630573, 0.992514877,
                0.992514877, 0.992514877, 0.992398562, 0.992398562, 0.992282173, 0.992165739, 0.992049285, 0.992049285,
                0.99193276, 0.991816122, 0.991699452, 0.991582702, 0.991465914, 0.991349122, 0.991232255, 0.991115362,
                0.99099844, 0.990881387, 0.990881387, 0.990764257, 0.990764257, 0.990646852, 0.990529399, 0.99041194,
                0.99041194, 0.990294124, 0.990176296, 0.990176296, 0.990058191, 0.989939936, 0.989939936, 0.989821602,
                0.989703254, 0.989703254, 0.989584663, 0.989466015, 0.989466015, 0.989347321, 0.98922858, 0.98922858,
                0.989109735, 0.988990804, 0.988871843, 0.988752729, 0.988633557, 0.98851439, 0.98851439, 0.988394742,
                0.988274939, 0.988274939, 0.988155063, 0.988035168, 0.988035168, 0.987915174, 0.987795163, 0.987675055,
                0.987675055, 0.987554926, 0.987554926, 0.987554926, 0.987434591, 0.98731421, 0.987193768, 0.987193768,
                0.987193768, 0.987072817, 0.986951684, 0.986951684, 0.986830404, 0.986830404, 0.986709003, 0.986587546,
                0.986466095, 0.986344481, 0.986344481, 0.986222715, 0.986222715, 0.986222715, 0.986100683, 0.985978497,
                0.985978497, 0.985856165, 0.985856165, 0.985733729, 0.985611141, 0.985488483, 0.985488483, 0.985365602,
                0.985242703, 0.985119406, 0.985119406, 0.985119406, 0.984995886, 0.984872351, 0.984872351, 0.984872351,
                0.984748582, 0.984748582, 0.984748582, 0.984624675, 0.984624675, 0.984500637, 0.984376575, 0.984252493,
                0.984128395, 0.984004254, 0.984004254, 0.983879905, 0.983879905, 0.983879905, 0.983755502, 0.983755502,
                0.983755502, 0.983630861, 0.983630861, 0.98350618, 0.983381484, 0.983256779, 0.983132, 0.983007145,
                0.98288229, 0.98288229, 0.982757355, 0.982632406, 0.982507442, 0.982507442, 0.982382346, 0.982382346,
                0.982257185, 0.982131956, 0.982131956, 0.982131956, 0.98200657, 0.98200657, 0.981881085, 0.981755544,
                0.98162994, 0.981504259, 0.981378543, 0.981378543, 0.981252697, 0.981126841, 0.981126841, 0.981000856,
                0.981000856, 0.981000856, 0.980874447, 0.980874447, 0.980747819, 0.980747819, 0.980621066, 0.980621066,
                0.980494204, 0.980494204, 0.980494204, 0.980366965, 0.980366965, 0.980239486, 0.980111906, 0.979984325,
                0.979984325, 0.979984325, 0.979856453, 0.979856453, 0.979728434, 0.979600368, 0.979472232, 0.979472232,
                0.979344037, 0.979215808, 0.979215808, 0.979215808, 0.979215808, 0.97908735, 0.97908735, 0.97908735,
                0.97908735, 0.978958646, 0.978829869, 0.978701086, 0.978572207, 0.978443194, 0.978443194, 0.978314057,
                0.978314057, 0.978184737, 0.978184737, 0.97805528, 0.977925797, 0.977925797, 0.977795841, 0.977795841,
                0.977795841, 0.977665752, 0.977665752, 0.977665752, 0.977535425, 0.977405024, 0.977405024, 0.977405024,
                0.97727435, 0.977143685, 0.977012951, 0.976882155, 0.976751179, 0.976751179, 0.976751179, 0.976620114,
                0.976488931, 0.976488931, 0.976357314, 0.976225666, 0.976225666, 0.976093954, 0.976093954, 0.976093954,
                0.976093954, 0.975961824, 0.975829493, 0.975696823, 0.975564136, 0.975431418, 0.975431418, 0.975431418,
                0.975298559, 0.975165608, 0.975032494, 0.975032494, 0.974899313, 0.974899313, 0.97476595, 0.97476595,
                0.974632414, 0.974498892, 0.974498892, 0.974498892, 0.974365187, 0.974365187, 0.974231447, 0.974097694,
                0.97396386, 0.97396386, 0.973829968, 0.973695705, 0.973695705, 0.973561302, 0.973561302, 0.973426812,
                0.97329233, 0.973157792, 0.973023165, 0.972888502, 0.972753686, 0.972753686, 0.972618599, 0.972483401,
                0.972348192, 0.972212959, 0.972212959, 0.972077497, 0.971942025, 0.971806564, 0.971806564, 0.971671016,
                0.971535469, 0.971399832, 0.971263727, 0.971127505, 0.971127505, 0.971127505, 0.971127505, 0.970990911,
                0.970854255, 0.970854255, 0.970716143, 0.970716143, 0.970577898, 0.970439634, 0.970439634, 0.970301283,
                0.970301283, 0.970162586, 0.970023864, 0.970023864, 0.970023864, 0.969885043, 0.969746157, 0.969746157,
                0.969607121, 0.969607121, 0.969467906, 0.969328605, 0.969328605, 0.969189095, 0.969049555, 0.96890993,
                0.968770148, 0.968630236, 0.968630236, 0.968490195, 0.968350094, 0.968350094, 0.968350094, 0.968350094,
                0.968209822, 0.968069503, 0.968069503, 0.967929069, 0.967788583, 0.967648104, 0.967507426, 0.967507426,
                0.967507426, 0.967507426, 0.967507426, 0.967366445, 0.967366445, 0.967366445, 0.967366445, 0.967366445,
                0.967225072, 0.967225072, 0.967225072, 0.967083346, 0.967083346, 0.966941484, 0.966941484, 0.966941484,
                0.966799431, 0.966657323, 0.966515221, 0.966515221, 0.966515221, 0.966372675, 0.966372675, 0.966230095,
                0.966087497, 0.965944844, 0.965802025, 0.965802025, 0.965659107, 0.965659107, 0.965515789, 0.965372381,
                0.965372381, 0.9652289, 0.965085397, 0.964941748, 0.964941748, 0.964941748, 0.964941748, 0.964797845,
                0.964797845, 0.964797845, 0.964797845, 0.964797845, 0.964652345, 0.964652345, 0.964652345, 0.964652345,
                0.964652345, 0.964506431, 0.964360374, 0.964214292, 0.964214292, 0.964067992, 0.963921559, 0.963921559,
                0.963774931, 0.963628306, 0.963481699, 0.963481699, 0.96333502, 0.963188259, 0.963041277, 0.962894248,
                0.962746922, 0.962746922, 0.962599438, 0.96245194, 0.962304394, 0.962156773, 0.962156773, 0.962008591,
                0.961860378, 0.961860378, 0.961711958, 0.961711958, 0.96156345, 0.96141486, 0.961266259, 0.961117297,
                0.960968325, 0.960968325, 0.960968325, 0.960819143, 0.960819143, 0.960669959, 0.960520666, 0.96037136,
                0.96037136, 0.96037136, 0.96037136, 0.96037136, 0.96037136, 0.96037136, 0.960220987, 0.960070585,
                0.959919945, 0.959919945, 0.959919945, 0.959919945, 0.959919945, 0.959768593, 0.959617193, 0.959617193,
                0.959617193, 0.959617193, 0.959617193, 0.959617193, 0.959617193, 0.959617193, 0.959464998, 0.959464998,
                0.959311842, 0.959311842, 0.959158581, 0.959005319, 0.958851942, 0.958698579, 0.958698579, 0.958698579,
                0.958698579, 0.958545052, 0.958391494, 0.958391494, 0.9582379, 0.9582379, 0.9582379, 0.9582379,
                0.9582379, 0.958083902, 0.958083902, 0.958083902, 0.957929622, 0.957774955, 0.957774955, 0.957774955,
                0.957774955, 0.957774955, 0.957619965, 0.957619965, 0.957619965, 0.957464847, 0.957464847, 0.957464847,
                0.957309328, 0.957309328, 0.957153637, 0.957153637, 0.957153637, 0.956997804, 0.956997804, 0.956841937,
                0.956686065, 0.956686065, 0.956686065, 0.956530084, 0.956373803, 0.956373803, 0.95621749, 0.956061106,
                0.955904677, 0.955748076, 0.955591451, 0.955434795, 0.955277962, 0.955277962, 0.955121, 0.955121,
                0.955121, 0.955121, 0.955121, 0.955121, 0.954962774, 0.954804098, 0.954645324, 0.954645324,
                0.954645324, 0.954645324, 0.954486493, 0.95432756, 0.95432756, 0.95432756, 0.95432756, 0.95416855,
                0.95416855, 0.954009522, 0.954009522, 0.953850254, 0.953850254, 0.953690764, 0.953531238, 0.953371712,
                0.953371712, 0.953212034, 0.953212034, 0.953212034, 0.953052195, 0.952892355, 0.952732504, 0.952732504,
                0.952572378, 0.952412089, 0.952412089, 0.952412089, 0.952412089, 0.952251457, 0.952090828, 0.952090828,
                0.95192976, 0.95192976, 0.951768682, 0.951768682, 0.951607477, 0.951446252, 0.951284944, 0.951123624,
                0.951123624, 0.950962256, 0.950800848, 0.950639444, 0.950639444, 0.950639444, 0.950477625, 0.950477625,
                0.950477625, 0.950315425, 0.950153204, 0.949990404, 0.949827405, 0.949664392, 0.949664392, 0.949664392,
                0.949664392, 0.94950083, 0.94950083, 0.94950083, 0.949337114, 0.949173378, 0.949009514, 0.949009514,
                0.94884555, 0.94884555, 0.94884555, 0.948681413, 0.948681413, 0.948681413, 0.948681413, 0.94851707,
                0.94851707, 0.94835196, 0.948186731, 0.948186731, 0.948186731, 0.948021228, 0.948021228, 0.948021228,
                0.947855307, 0.947689386, 0.947689386, 0.947523355, 0.947357331, 0.947357331, 0.947357331, 0.947190969,
                0.947024487, 0.946857953, 0.946857953, 0.946857953, 0.946691255, 0.946524514, 0.946357651, 0.946190793,
                0.946190793, 0.946190793, 0.946023761, 0.94585657, 0.94585657, 0.945689233, 0.945521884, 0.945354446,
                0.945186936, 0.945186936, 0.945186936, 0.945019075, 0.945019075, 0.944850821, 0.944850821, 0.944682248,
                0.944682248, 0.94451354, 0.944344834, 0.944344834, 0.944344834, 0.944344834, 0.944344834, 0.944344834,
                0.944175357, 0.944005645, 0.944005645, 0.943835795, 0.943835795, 0.943665924, 0.943495963, 0.943495963,
                0.943325882, 0.943325882, 0.943155626, 0.942985392, 0.942985392, 0.942814967, 0.942814967, 0.942814967,
                0.942814967, 0.942644357, 0.942644357, 0.942644357, 0.942473429, 0.94230248, 0.942131355, 0.941960133,
                0.941960133, 0.941788768, 0.941788768, 0.941617217, 0.941445654, 0.941274104, 0.941102559, 0.941102559,
                0.940930621, 0.940930621, 0.94075829, 0.940585684, 0.940585684, 0.940585684, 0.940585684, 0.940585684,
                0.940585684, 0.940412685, 0.940239648, 0.940066612, 0.940066612, 0.939893345, 0.939893345, 0.939893345,
                0.9397196, 0.939545671, 0.939545671, 0.939545671, 0.939545671, 0.939545671, 0.939545671, 0.939545671,
                0.939545671, 0.939370907, 0.939370907, 0.939370907, 0.939196015, 0.939196015, 0.9390211, 0.9390211,
                0.938845833, 0.938845833, 0.938845833, 0.938845833, 0.938670447, 0.938670447, 0.938670447, 0.938494837,
                0.938319253, 0.938319253, 0.938143619, 0.93796798, 0.93796798, 0.93796798, 0.937792057, 0.937615924,
                0.937615924, 0.937439603, 0.937263072, 0.937086451, 0.937086451, 0.937086451, 0.936909665, 0.936909665,
                0.936732791, 0.936555948, 0.936555948, 0.936555948, 0.936555948, 0.936555948, 0.936377819, 0.936377819,
                0.936377819, 0.936199497, 0.936199497, 0.936020453, 0.936020453, 0.936020453, 0.936020453, 0.936020453,
                0.935840668, 0.935840668, 0.935840668, 0.935660462, 0.935480231, 0.935299883, 0.935299883, 0.935299883,
                0.935299883, 0.935299883, 0.935119065, 0.935119065, 0.935119065, 0.935119065, 0.934937369, 0.934937369,
                0.93475556, 0.93475556, 0.934573728, 0.934573728, 0.934391818, 0.934391818, 0.934209879, 0.934209879,
                0.934209879, 0.934209879, 0.934027171, 0.934027171, 0.933844279, 0.933661317, 0.933661317, 0.933478056,
                0.933478056, 0.933294766, 0.933111166, 0.933111166, 0.932926983, 0.932742769, 0.932558451, 0.932374008,
                0.932374008, 0.932374008, 0.932374008, 0.932188981, 0.932003552, 0.932003552, 0.931818076, 0.931632571,
                0.931447047, 0.93126135, 0.93126135, 0.93126135, 0.93126135, 0.93126135, 0.931075055, 0.930888744,
                0.930888744, 0.930888744, 0.930701713, 0.930701713, 0.930701713, 0.930514165, 0.930326462, 0.930326462,
                0.930326462, 0.930326462, 0.930138065, 0.929949486, 0.929949486, 0.929949486, 0.929949486, 0.929760152,
                0.929570745, 0.929570745, 0.929570745, 0.929380944, 0.929380944, 0.929380944, 0.929380944, 0.929380944,
                0.929380944, 0.92918916, 0.928997392, 0.928997392, 0.928997392, 0.928805459, 0.928613126, 0.928613126,
                0.928613126, 0.928613126, 0.928420021, 0.928226946, 0.928226946, 0.928226946, 0.928226946, 0.928226946,
                0.928226946, 0.928226946, 0.928226946, 0.928226946, 0.928226946, 0.928226946, 0.928226946, 0.928031824,
                0.928031824, 0.928031824, 0.928031824, 0.927836316, 0.927836316, 0.927640467, 0.927444576, 0.927444576,
                0.927444576, 0.927444576, 0.92724812, 0.92724812, 0.92724812, 0.92724812, 0.927051222, 0.926853248,
                0.926655181, 0.926655181, 0.926456979, 0.926258616, 0.926258616, 0.926060232, 0.926060232, 0.925861012,
                0.925661703, 0.92546209, 0.925262475, 0.925062826, 0.925062826, 0.924862888, 0.924662622, 0.924462351,
                0.924261758, 0.924261758, 0.924261758, 0.924060941, 0.924060941, 0.924060941, 0.924060941, 0.924060941,
                0.923859719, 0.923658372, 0.923456846, 0.923456846, 0.923456846, 0.923456846, 0.92325444, 0.92325444,
                0.923051693, 0.923051693, 0.923051693, 0.922848018, 0.922644281, 0.922644281, 0.922440225, 0.922440225,
                0.922440225, 0.922235278, 0.92203034, 0.92203034, 0.92203034, 0.921824808, 0.921824808, 0.921824808,
                0.921619012, 0.921413184, 0.921207316, 0.921207316, 0.921207316, 0.921207316, 0.92100099, 0.92100099,
                0.92100099, 0.920794493, 0.920587902, 0.920381004, 0.920174134, 0.920174134, 0.919966596, 0.919758588,
                0.919550543, 0.919550543, 0.919342352, 0.919134183, 0.919134183, 0.918925895, 0.918925895, 0.918717354,
                0.918508672, 0.918299597, 0.918090276, 0.918090276, 0.918090276, 0.917880584, 0.917880584, 0.917670665,
                0.917670665, 0.917670665, 0.917670665, 0.917460044, 0.917460044, 0.917460044, 0.917460044, 0.917248916,
                0.917248916, 0.917248916, 0.917037134, 0.916824573, 0.916611331, 0.916611331, 0.916611331, 0.916611331,
                0.916396435, 0.916396435, 0.916396435, 0.916180894, 0.91596538, 0.91596538, 0.91596538, 0.91596538,
                0.915748037, 0.915748037, 0.915748037, 0.915748037, 0.915529365, 0.915529365, 0.915309984, 0.915309984,
                0.915089997, 0.915089997, 0.914869669, 0.914869669, 0.914869669, 0.914869669
            }
            Dim J As Vector = {
                1, 0.999877285, 0.999754544, 0.999754544, 0.999754544, 0.999631656, 0.999631656, 0.999508664,
                0.999385572, 0.999385572, 0.999262395, 0.999262395, 0.999139173, 0.999015856, 0.999015856, 0.999015856,
                0.999015856, 0.999015856, 0.998892061, 0.998768276, 0.998768276, 0.998644338, 0.998644338, 0.998644338,
                0.99852026, 0.998396037, 0.998396037, 0.998396037, 0.998396037, 0.99827162, 0.99827162, 0.998147122,
                0.998147122, 0.998022525, 0.997897659, 0.997772801, 0.997772801, 0.997772801, 0.997772801, 0.997647672,
                0.997647672, 0.997647672, 0.997647672, 0.997647672, 0.997647672, 0.997647672, 0.997647672, 0.997647672,
                0.997521468, 0.997395249, 0.997395249, 0.997395249, 0.997395249, 0.997268511, 0.997141769, 0.997141769,
                0.997141769, 0.997141769, 0.997141769, 0.997141769, 0.997141769, 0.997141769, 0.997141769, 0.997141769,
                0.997141769, 0.997141769, 0.997141769, 0.997141769, 0.997013857, 0.997013857, 0.997013857, 0.997013857,
                0.997013857, 0.996885746, 0.996885746, 0.99675757, 0.99675757, 0.996629046, 0.996500415, 0.996371794,
                0.996371794, 0.996371794, 0.996371794, 0.996371794, 0.99624301, 0.996114192, 0.996114192, 0.996114192,
                0.996114192, 0.996114192, 0.996114192, 0.99598468, 0.995855165, 0.995725597, 0.995595925, 0.995595925,
                0.995595925, 0.995595925, 0.995595925, 0.995595925, 0.995595925, 0.995465907, 0.995465907, 0.995335604,
                0.995205271, 0.995205271, 0.995074821, 0.995074821, 0.995074821, 0.995074821, 0.994944218, 0.994944218,
                0.994944218, 0.994944218, 0.994944218, 0.994944218, 0.994944218, 0.994944218, 0.994944218, 0.994944218,
                0.994944218, 0.994812814, 0.994812814, 0.994681269, 0.994681269, 0.994681269, 0.994681269, 0.994549161,
                0.994549161, 0.994549161, 0.99441697, 0.99441697, 0.99441697, 0.994284413, 0.994284413, 0.994284413,
                0.994151553, 0.994151553, 0.994151553, 0.994018498, 0.994018498, 0.994018498, 0.993885265, 0.993885265,
                0.993885265, 0.993885265, 0.993885265, 0.993885265, 0.993885265, 0.993751532, 0.993751532, 0.993751532,
                0.993617235, 0.993617235, 0.993617235, 0.993482859, 0.993482859, 0.993482859, 0.993482859, 0.993348291,
                0.993348291, 0.993213656, 0.993078862, 0.993078862, 0.993078862, 0.993078862, 0.99294386, 0.992808446,
                0.992808446, 0.992808446, 0.992672703, 0.992672703, 0.992536714, 0.992536714, 0.992536714, 0.992536714,
                0.992536714, 0.992400502, 0.992400502, 0.99226416, 0.992127771, 0.992127771, 0.992127771, 0.991991101,
                0.991991101, 0.991854247, 0.991854247, 0.991854247, 0.991854247, 0.991716994, 0.991716994, 0.991716994,
                0.991716994, 0.991579218, 0.991441147, 0.991441147, 0.991441147, 0.991302878, 0.99116455, 0.99116455,
                0.991026071, 0.990887606, 0.990887606, 0.990748967, 0.990748967, 0.990748967, 0.990748967, 0.990748967,
                0.990748967, 0.990610021, 0.990610021, 0.990470985, 0.990331936, 0.990331936, 0.990192776, 0.990053625,
                0.990053625, 0.9899143, 0.9899143, 0.9899143, 0.9899143, 0.9899143, 0.9899143, 0.9899143, 0.989774681,
                0.989774681, 0.989774681, 0.989774681, 0.989634881, 0.989634881, 0.98949498, 0.98949498, 0.98949498,
                0.98935486, 0.989214646, 0.989214646, 0.989074368, 0.989074368, 0.989074368, 0.989074368, 0.989074368,
                0.989074368, 0.988933633, 0.988933633, 0.988933633, 0.98879268, 0.98879268, 0.988651572, 0.988510447,
                0.988510447, 0.98836905, 0.98836905, 0.988227536, 0.988227536, 0.98808586, 0.98808586, 0.987943669,
                0.987801425, 0.987801425, 0.987658938, 0.987658938, 0.987658938, 0.987658938, 0.98751613, 0.987373315,
                0.987373315, 0.987230311, 0.987230311, 0.987230311, 0.987230311, 0.987086981, 0.987086981, 0.987086981,
                0.986943431, 0.986799798, 0.986656134, 0.986656134, 0.986512299, 0.986368466, 0.986224546, 0.986224546,
                0.986224546, 0.986224546, 0.986224546, 0.986224546, 0.986080241, 0.986080241, 0.985935786, 0.985935786,
                0.985791137, 0.985791137, 0.985791137, 0.985646236, 0.985646236, 0.985501229, 0.985356192, 0.985356192,
                0.985211015, 0.985065817, 0.985065817, 0.985065817, 0.984920047, 0.984774054, 0.984774054, 0.984774054,
                0.984774054, 0.984774054, 0.984774054, 0.984627712, 0.984481332, 0.984481332, 0.984481332, 0.984334645,
                0.984334645, 0.984334645, 0.984187717, 0.984187717, 0.984040565, 0.983893359, 0.983746108, 0.983746108,
                0.983746108, 0.983746108, 0.983746108, 0.983746108, 0.983598124, 0.983450134, 0.983450134, 0.983450134,
                0.983450134, 0.983301738, 0.983301738, 0.983153231, 0.983153231, 0.983004596, 0.983004596, 0.983004596,
                0.982855852, 0.982707103, 0.982707103, 0.982558273, 0.982558273, 0.982558273, 0.982558273, 0.982409289,
                0.982409289, 0.982409289, 0.982260033, 0.982260033, 0.98211057, 0.98211057, 0.98211057, 0.98211057,
                0.98211057, 0.98211057, 0.98211057, 0.981960382, 0.981960382, 0.981960382, 0.981960382, 0.981960382,
                0.9818098, 0.9818098, 0.9818098, 0.9818098, 0.981658873, 0.981658873, 0.981658873, 0.981658873,
                0.981658873, 0.981658873, 0.98150718, 0.981355389, 0.981203556, 0.981203556, 0.981203556, 0.981051451,
                0.981051451, 0.980899036, 0.980899036, 0.980899036, 0.980746444, 0.980746444, 0.980593667, 0.980593667,
                0.980593667, 0.980440701, 0.980287738, 0.980287738, 0.980287738, 0.980134532, 0.980134532, 0.979981207,
                0.979981207, 0.979981207, 0.979827611, 0.979827611, 0.979827611, 0.979827611, 0.979827611, 0.979827611,
                0.979673456, 0.979673456, 0.979673456, 0.979518884, 0.979364324, 0.979209767, 0.979209767, 0.979209767,
                0.97905505, 0.97905505, 0.97905505, 0.97905505, 0.97905505, 0.978900127, 0.978745173, 0.978590153,
                0.97843509, 0.97843509, 0.978279837, 0.978124543, 0.977969254, 0.977813891, 0.977813891, 0.977658162,
                0.977502357, 0.977502357, 0.977346366, 0.977346366, 0.977190322, 0.97703417, 0.97703417, 0.97703417,
                0.97703417, 0.976877834, 0.976721499, 0.976721499, 0.976564931, 0.976564931, 0.976564931, 0.976564931,
                0.976564931, 0.976407876, 0.976407876, 0.976250519, 0.976250519, 0.976250519, 0.976092957, 0.976092957,
                0.976092957, 0.976092957, 0.975935151, 0.975777142, 0.975619126, 0.975619126, 0.975460489, 0.975301645,
                0.975142652, 0.974983388, 0.974983388, 0.974823932, 0.974664418, 0.974504677, 0.974344931, 0.974344931,
                0.974344931, 0.974344931, 0.974184654, 0.974184654, 0.974184654, 0.97402423, 0.97402423, 0.97402423,
                0.97402423, 0.973863623, 0.973863623, 0.973863623, 0.973863623, 0.973863623, 0.973863623, 0.973702293,
                0.973702293, 0.973702293, 0.973702293, 0.973702293, 0.973540153, 0.973540153, 0.973540153, 0.973377514,
                0.973377514, 0.973214761, 0.973214761, 0.973214761, 0.973214761, 0.973214761, 0.973214761, 0.973051484,
                0.972888192, 0.972888192, 0.97272488, 0.97272488, 0.97272488, 0.97272488, 0.972561372, 0.972397741,
                0.972233909, 0.972070078, 0.971906094, 0.971741968, 0.971741968, 0.971741968, 0.971741968, 0.97157724,
                0.97141228, 0.971247066, 0.971081784, 0.971081784, 0.971081784, 0.9709163, 0.970750726, 0.970585117,
                0.970419496, 0.97025382, 0.970087889, 0.969921971, 0.969921971, 0.969755552, 0.969755552, 0.969588543,
                0.969588543, 0.969588543, 0.969588543, 0.969588543, 0.969421233, 0.969253941, 0.96908662, 0.96908662,
                0.96908662, 0.968919122, 0.968919122, 0.968751569, 0.968584016, 0.968416359, 0.968248694, 0.968248694,
                0.968080887, 0.967912949, 0.967912949, 0.967912949, 0.967744501, 0.967575948, 0.967407365, 0.967238764,
                0.967238764, 0.967070012, 0.966901269, 0.966901269, 0.966732415, 0.966563563, 0.966563563, 0.966394448,
                0.966394448, 0.966225159, 0.966055746, 0.966055746, 0.965886288, 0.965886288, 0.965886288, 0.965716729,
                0.965547174, 0.965547174, 0.965547174, 0.965377159, 0.965377159, 0.965377159, 0.965377159, 0.965377159,
                0.965377159, 0.965377159, 0.965377159, 0.965206376, 0.965206376, 0.965035481, 0.964864256, 0.964692999,
                0.964521516, 0.964350053, 0.964350053, 0.964350053, 0.964350053, 0.964177297, 0.964004525, 0.963831778,
                0.963831778, 0.963831778, 0.963658887, 0.963485998, 0.963313092, 0.963313092, 0.963140174, 0.963140174,
                0.962967139, 0.962967139, 0.962793848, 0.962793848, 0.962793848, 0.962793848, 0.96262023, 0.96262023,
                0.962446273, 0.962272325, 0.962272325, 0.962272325, 0.962272325, 0.962098219, 0.962098219, 0.962098219,
                0.961923424, 0.96174856, 0.961573714, 0.961573714, 0.961573714, 0.961398572, 0.961398572, 0.961223286,
                0.961223286, 0.961047939, 0.961047939, 0.961047939, 0.961047939, 0.961047939, 0.960872253, 0.960872253,
                0.960872253, 0.960872253, 0.960696398, 0.960520282, 0.960520282, 0.960344039, 0.960167734, 0.960167734,
                0.960167734, 0.960167734, 0.960167734, 0.960167734, 0.959990343, 0.959812589, 0.959634839, 0.959634839,
                0.959457073, 0.959279325, 0.959279325, 0.959279325, 0.959279325, 0.959101175, 0.959101175, 0.958922981,
                0.958744797, 0.958744797, 0.958566468, 0.958388117, 0.958209794, 0.958209794, 0.958030939, 0.958030939,
                0.958030939, 0.95785173, 0.957672466, 0.957672466, 0.957492956, 0.957313431, 0.957313431, 0.957313431,
                0.95713379, 0.95713379, 0.95713379, 0.956954017, 0.956774052, 0.956774052, 0.956774052, 0.956774052,
                0.956593787, 0.956413464, 0.956413464, 0.956413464, 0.956413464, 0.956413464, 0.956232749, 0.956052006,
                0.956052006, 0.956052006, 0.95587103, 0.95587103, 0.95587103, 0.95587103, 0.95587103, 0.955689655,
                0.955508217, 0.955508217, 0.955326496, 0.955326496, 0.955144486, 0.955144486, 0.954962297, 0.954962297,
                0.954962297, 0.954779788, 0.954597076, 0.954414194, 0.954231301, 0.954048382, 0.954048382, 0.954048382,
                0.953864911, 0.953864911, 0.953681346, 0.953681346, 0.953681346, 0.953497539, 0.953497539, 0.953313578,
                0.953313578, 0.953313578, 0.953129505, 0.953129505, 0.952945232, 0.952760904, 0.952576294, 0.952576294,
                0.952391548, 0.952206614, 0.952206614, 0.952206614, 0.952206614, 0.952206614, 0.952021082, 0.952021082,
                0.951835412, 0.951835412, 0.951835412, 0.951835412, 0.951835412, 0.951649397, 0.951649397, 0.951462826,
                0.951462826, 0.951462826, 0.951275939, 0.951089054, 0.950902017, 0.950714966, 0.95052786, 0.95052786,
                0.95052786, 0.95052786, 0.950340558, 0.950340558, 0.950153047, 0.949965546, 0.949965546, 0.949965546,
                0.949777415, 0.949589181, 0.949400978, 0.949212692, 0.949024356, 0.948835936, 0.948647515, 0.948647515,
                0.948459026, 0.948270565, 0.948270565, 0.948081959, 0.948081959, 0.947893237, 0.947893237, 0.947704387,
                0.947515495, 0.947326615, 0.947326615, 0.947137713, 0.946948593, 0.946948593, 0.946948593, 0.946759248,
                0.946759248, 0.946759248, 0.946569773, 0.946380199, 0.946380199, 0.946380199, 0.946190252, 0.946190252,
                0.946190252, 0.946190252, 0.945999896, 0.945809399, 0.945809399, 0.945618786, 0.945618786, 0.945618786,
                0.945427935, 0.945237011, 0.945045991, 0.944854867, 0.944854867, 0.944663384, 0.944471836, 0.944471836,
                0.944280201, 0.944280201, 0.944088061, 0.943895806, 0.943703509, 0.943511074, 0.943511074, 0.943318489,
                0.943125611, 0.943125611, 0.943125611, 0.943125611, 0.942932211, 0.942738818, 0.942545337, 0.942351765,
                0.942351765, 0.942158006, 0.941963858, 0.941769602, 0.941769602, 0.941575129, 0.941575129, 0.94138054,
                0.94138054, 0.941185958, 0.941185958, 0.940991283, 0.940991283, 0.940796305, 0.94060109, 0.940405643,
                0.940405643, 0.94021016, 0.94021016, 0.94021016, 0.940014094, 0.940014094, 0.939817859, 0.939817859,
                0.939817859, 0.9396209, 0.9396209, 0.9396209, 0.9396209, 0.9396209, 0.939423536, 0.939225901,
                0.939028065, 0.939028065, 0.939028065, 0.938829382, 0.938829382, 0.938829382, 0.938829382, 0.938829382,
                0.938630398, 0.938431416, 0.938232203, 0.938032962, 0.938032962, 0.938032962, 0.937832993, 0.937633039,
                0.937633039, 0.937432695, 0.937231967, 0.937231967, 0.937231967, 0.937030775, 0.936829613, 0.936628459,
                0.936628459, 0.936628459, 0.936427016, 0.936225589, 0.936024068, 0.936024068, 0.936024068, 0.935821855,
                0.935619655, 0.935619655, 0.935416967, 0.935214117, 0.935010744, 0.934807377, 0.934603907, 0.934603907,
                0.934603907, 0.934400281, 0.934196621, 0.934196621, 0.934196621, 0.933992242, 0.933787762, 0.933582999,
                0.933582999, 0.933582999, 0.933378123, 0.933173258, 0.932968293, 0.932763349, 0.932558038, 0.932352688,
                0.932147036, 0.931941303, 0.931735599, 0.931529917, 0.931324037, 0.931324037, 0.931118114, 0.930912138,
                0.93070607, 0.93070607, 0.930499878, 0.930499878, 0.930499878, 0.930293461, 0.930086896, 0.929880137,
                0.929880137, 0.929673167, 0.929466177, 0.929259036, 0.929259036, 0.929259036, 0.929259036, 0.929051026,
                0.929051026, 0.929051026, 0.928842877, 0.928842877, 0.928634347, 0.928634347, 0.928634347, 0.928634347,
                0.928634347, 0.928634347, 0.928424622, 0.928424622, 0.928424622, 0.928424622, 0.928424622, 0.928214193,
                0.928003671, 0.928003671, 0.927793068, 0.92758246, 0.927371675, 0.927160675, 0.927160675, 0.927160675,
                0.927160675, 0.926948875, 0.926736824, 0.926524741, 0.926524741, 0.92631232, 0.92631232, 0.926099272,
                0.925885736, 0.925885736, 0.925885736, 0.92567187, 0.92567187, 0.925457369, 0.925242741, 0.925242741,
                0.925242741, 0.925027475, 0.924812136, 0.924812136, 0.924596415, 0.924380661, 0.924380661, 0.924380661,
                0.924380661, 0.924164658, 0.923948666, 0.923732599, 0.923732599, 0.923516365, 0.923299989, 0.923299989,
                0.923299989, 0.923299989, 0.923299989, 0.923083088, 0.923083088, 0.923083088, 0.923083088, 0.922865545,
                0.922865545, 0.922865545, 0.922647837, 0.922647837, 0.92242982, 0.92242982, 0.92242982, 0.92242982,
                0.92242982, 0.922210775, 0.9219915, 0.9219915, 0.921771962, 0.921771962, 0.921551966, 0.921331785,
                0.921111452, 0.921111452, 0.920890917, 0.920670431, 0.920449623, 0.920449623, 0.920228342, 0.920006364,
                0.920006364, 0.920006364, 0.920006364, 0.91978216, 0.919557671, 0.919333012, 0.919333012, 0.919107533,
                0.918881934, 0.918881934, 0.918881934, 0.918655995, 0.918429711, 0.918202833, 0.918202833, 0.917975265,
                0.917746666, 0.917518009, 0.917518009, 0.917288907, 0.917288907, 0.917059209, 0.917059209, 0.916829168,
                0.916829168, 0.916598516, 0.916367679, 0.916136657
            }

            Dim F As New Vector(1500)
            Dim G As New Vector(1500)
            Dim K As New Vector(1500)
            Dim M As New Vector(1500)
            Dim Z As New Vector(1500)
            Dim AA As New Vector(1500)
            Dim AB As New Vector(1500)
            Dim AD As New Vector(1500)
            Dim AE As New Vector(1500)
            Dim AF As New Vector(1500)
            Dim Q2 = If(isMale, 1, 0)
            Dim Q3 = Math.Log(age)
            Dim Q4 = Math.Log(systolicBp)
            Dim Q5 = Math.Log(cholesterol)
            Dim Q6 = Math.Log(hdl)
            Dim Q7 = If(smoker, 1, 0)
            Dim Q8 = If(treatedBp, 1, 0)
            Dim Q9 = If(diabetic, 1, 0)
            Dim R2 = 0.55021
            Dim R3 = 2.83511
            Dim R4 = 1.99822
            Dim R5 = 1.4775
            Dim R6 = -0.86736
            Dim R7 = 0.70063
            Dim R8 = 0.39241
            Dim R9 = 0.9137
            Dim S2 = Q2 * R2
            Dim S3 = Q3 * R3
            Dim S4 = Q4 * R4
            Dim S5 = Q5 * R5
            Dim S6 = Q6 * R6
            Dim S7 = Q7 * R7
            Dim S8 = Q8 * R8
            Dim S9 = Q9 * R9
            Dim S11 = S2 + S3 + S4 + S5 + S6 + S7 + S8 + S9
            Dim T2 = 0.47666
            Dim T3 = 3.53291
            Dim T4 = 1.43216
            Dim T5 = 0.00704
            Dim T6 = 0.09148
            Dim T7 = 0.97352
            Dim T8 = 0.11888
            Dim T9 = 0.45355
            Dim U2 = Q2 * T2
            Dim U3 = Q3 * T3
            Dim U4 = Q4 * T4
            Dim U5 = Q5 * T5
            Dim U6 = Q6 * T6
            Dim U7 = Q7 * T7
            Dim U8 = Q8 * T8
            Dim U9 = Q9 * T9
            Dim U11 = U2 + U3 + U4 + U5 + U6 + U7 + U8 + U9
            Dim W2 = 24.72839981
            Dim W5 = Math.Exp(S11 - W2)
            Dim X2 = 20.56609979
            Dim X5 = Math.Exp(U11 - X2)

            ' set F
            F($"0:{Math.Min(E.Length, F.Length) - 1}") = E ^ W5
            ' for (i = 0; i < E.length && i < F.length; i++) {
            '	F[i] = Math.Pow(E[i], W5);
            '}

            ' set G
            G($"0,{E.Length - 1}") = E _
                .SlideWindows(2) _
                .Select(Function(x)
                            Return Math.Log(x(0)) - Math.Log(x(1))
                        End Function) _
                .AsList
            ' for (i = 0; i + 1 < E.length; i++) {
            '     G[i] = Math.Log(E[i]) - Math.Log(E[i + 1]);
            ' }

            ' set K
            K($"0:{Math.Min(K.Length, J.Length) - 1}") = J ^ X5
            ' for (i = 0; i < K.length && i < J.length; i++) {
            '     K[i] = Math.Pow(J[i], X5);
            ' }

            ' set M
            M(0) = W5 * (-Math.Log(E(0)))
            M($"1:{ {M.Length, F.Length, K.Length, G.Length}.Min - 1 }") = F * K * W5 * G
            ' for (i = 0; i + 1 < M.length && i < F.length && i < K.length && i < G.length; i++) {
            '     M[i + 1] = F[i] * K[i] * W5 * G[i];
            ' }

            ' now we can calculate the risk values
            Dim hardRisk = Aggregate x As Double
                           In M
                           Where Not x.IsNaNImaginary
                           Into Sum(x)
            ' for (i = 0; i < M.length && !isNaN(M[i]); i++) {
            '     hardRisk = hardRisk + M[i];
            ' }

            Return Math.Round(100 * hardRisk)
        End Function
    End Module

    Public Class Score30

        Public Property risk As Double
        Public Property optimalRisk As Double
        Public Property normalRisk As Double

        Public Overrides Function ToString() As String
            Return Me.GetJson
        End Function
    End Class
End Namespace